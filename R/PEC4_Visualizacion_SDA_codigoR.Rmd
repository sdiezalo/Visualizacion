---
title: 'Visualizacion de datos'
subtitle: 'PRACTICA 4'
author: "Autor: Stela Diez Alonso"
date: "Junio 2020"
output:
  pdf_document:
    highlight: zenburn
    toc: yes
  html_document:
    highlight: default
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_depth: 2
  word_document: default
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

******
******

```{r echo=TRUE, message=FALSE, warning=FALSE}

# Cargamos las librerias que vamos a usar
if(!require(dplyr)){
    install.packages('dplyr')
    library(dplyr)
}

if(!require(ggplot2)){
    install.packages('ggplot2')
    library(ggplot2)
}
if(!require(stringr)){
    install.packages('stringr')
    library(stringr)
}
if(!require(readr)){
    install.packages('readr')
    library(readr)
}
if(!require(psych)){
    install.packages('psych')
    library(psych)
}
if(!require(FactoMineR)){
    install.packages('FactoMineR')
    library(FactoMineR)
}
if(!require(factoextra)){
    install.packages('factoextra')
    library(factoextra)
}
if(!require(corrplot)){
    install.packages('corrplot')
    library(corrplot)
}
if(!require(MASS)){
    install.packages('MASS')
    library(MASS)
}
if(!require(texreg)){
    install.packages('texreg')
    library(texreg)
}
if(!require(gmodels)){
    install.packages('gmodels')
    library(gmodels)
}



```


```{r echo=TRUE, message=FALSE, warning=FALSE}
# Cargamos los datos con los que vamos a trabajar
# Si desea correr la aplicación en local debe modificar la ruta al fichero.
fichero2 = 'C:\\Users\\sdiez\\Documents\\Visualizacion de Datos\\PEC 3\\pax_data_1832_agreements_04-05-20.csv'
datos <- read_csv(fichero2,skip = 0,col_names = TRUE)

# Mostramos los tipos de datos que tenemos
str(datos)

```



```{r echo=TRUE, message=FALSE, warning=FALSE}
# Creamos el subset de datos y renombramos las columnas
variables_seleccionadas <- c('Con','Contp','PP','PPName','Reg','AgtId','Agt','Dat','Status','Agtp','Stage','GCh','GDis','GAge',
                             'GMig','GRa','GRe','GInd','GOth','GRef','GSoc','StSd','StRef','StInd','StUni','StBor','Cons','Ele',
                             'Terps','Eps','Mps','EqGen','HrDem','HrCp','HrSec','Dev','LaEn','SsrGua','Ce','Cor','SsrCrOcr',
                             'Terr','TjCou')
datos2 <- datos[variables_seleccionadas]
names(datos2) = c('Paises/Entidades','Tipo de conflicto','Numero del proceso','Nombre del proceso','Region','Id del acuerdo',
                  'Nombre del acuerdo','Fecha','Definicion y estado','Tipo de conflicto2','Fase del acuerdo','Grupo infancia',
                  'Grupo discapacitados','Grupo ancianos','Grupo migrantes','Grupo racial','Grupo religion','Grupo indigenas',
                  'Grupo otros','Grupo refugiados','Grupo social','Estado - autodeterminacion','Estado - referendum',
                  'Estado - secesion','Estado - unificacion','Estado - fronteras','Constitucion reforma o creacion',
                  'Elecciones','Reparto de territorios','Reparto economico','Reparto militar','Igualdad de genero',
                  'Democracia','Derechos civiles','Derechos socioeconomicos','Desarrollo','Medio ambiente','Seguridad',
                  'Alto el fuego','Corrupcion','Crimer organizado','Terrorismo','Justicia')

# Estadisticas de valores vacios
colSums(is.na(datos2))
```


No hay datos vacios, por lo que podemos continuar


```{r echo=TRUE, message=FALSE, warning=FALSE}
# Estudiamos para que variables sentido un proceso de discretizacion
apply(datos2,2, function(x) length(unique(x)))

```

Discretizamos las variables que tienen pocos elementos unicos y las variables que originariamente son discretas aunque parecian de tipo numerico. 

```{r echo=TRUE, message=FALSE, warning=FALSE}

# Discretizamos las variables con pocas clases
datos2$"Tipo de conflicto" <- as.factor(datos2$"Tipo de conflicto")
datos2$"Region" <- as.factor(datos2$"Region")
datos2$"Definicion y estado" <- as.factor(datos2$"Definicion y estado")
datos2$"Tipo de conflicto2" <- as.factor(datos2$"Tipo de conflicto2")
datos2$"Fase del acuerdo" <- as.factor(datos2$"Fase del acuerdo")

#Factorizamos los datos que son categoricos discretos y en la base de datos aparecian como numericos. 
datos2$'Estado - autodeterminacion' <- as.factor(datos2$'Estado - autodeterminacion')
datos2$'Estado - referendum' <- as.factor(datos2$'Estado - referendum')
datos2$'Estado - secesion' <- as.factor(datos2$'Estado - secesion')
datos2$'Estado - unificacion' <- as.factor(datos2$'Estado - unificacion')
datos2$'Estado - fronteras' <- as.factor(datos2$'Estado - fronteras')
datos2$'Derechos civiles' <- as.factor(datos2$'Derechos civiles')
datos2$'Derechos socioeconomicos' <- as.factor(datos2$'Derechos socioeconomicos')
datos2$'Medio ambiente' <- as.factor(datos2$'Medio ambiente')
datos2$'Seguridad' <- as.factor(datos2$'Seguridad')
datos2$'Terrorismo' <- as.factor(datos2$'Terrorismo')

```


Ademas, creamos variables binarias que marque la presencia o ausencia y que seran tipo factor

```{r echo=TRUE, message=FALSE, warning=FALSE}
#creamos una variable 
datos2$'Grupo infancia bin' <- datos2$'Grupo infancia'
datos2$'Grupo discapacitados bin' <- datos2$'Grupo discapacitados'
datos2$'Grupo ancianos bin' <- datos2$'Grupo ancianos'
datos2$'Grupo migrantes bin' <- datos2$'Grupo migrantes'
datos2$'Grupo racial bin' <- datos2$'Grupo racial'
datos2$'Grupo religion bin' <- datos2$'Grupo religion'
datos2$'Grupo indigenas bin' <- datos2$'Grupo indigenas'
datos2$'Grupo otros bin' <- datos2$'Grupo otros'
datos2$'Grupo refugiados bin' <- datos2$'Grupo refugiados'
datos2$'Grupo social bin' <- datos2$'Grupo social'
datos2$'Constitucion reforma o creacion bin' <- datos2$'Constitucion reforma o creacion'
datos2$'Elecciones bin' <- datos2$'Elecciones'
datos2$'Reparto de territorios bin' <- datos2$'Reparto de territorios'
datos2$'Reparto economico bin' <- datos2$'Reparto economico'
datos2$'Reparto militar bin' <- datos2$'Reparto militar'
datos2$'Igualdad de genero bin' <- datos2$'Igualdad de genero'
datos2$'Democracia bin' <- datos2$'Democracia'
datos2$'Desarrollo bin' <- datos2$'Desarrollo'
datos2$'Alto el fuego bin' <- datos2$'Alto el fuego'
datos2$'Corrupcion bin' <- datos2$'Corrupcion'
datos2$'Crimer organizado bin' <- datos2$'Crimer organizado'
datos2$'Justicia bin' <- datos2$'Justicia'

# Asignamos el valor que queremos que tenga
datos2$'Grupo infancia bin'[datos2$'Grupo infancia bin'>0] = 1
datos2$'Grupo discapacitados bin'[datos2$'Grupo discapacitados bin'>0] = 1
datos2$'Grupo ancianos bin'[datos2$'Grupo ancianos bin'>0] = 1
datos2$'Grupo migrantes bin'[datos2$'Grupo migrantes bin'>0] = 1
datos2$'Grupo racial bin'[datos2$'Grupo racial bin'>0] = 1
datos2$'Grupo religion bin'[datos2$'Grupo religion bin'>0] = 1
datos2$'Grupo indigenas bin'[datos2$'Grupo indigenas bin'>0] = 1
datos2$'Grupo otros bin'[datos2$'Grupo otros bin'>0] = 1
datos2$'Grupo refugiados bin'[datos2$'Grupo refugiados bin'>0] = 1
datos2$'Grupo social bin'[datos2$'Grupo social bin'>0] = 1
datos2$'Constitucion reforma o creacion bin'[datos2$'Constitucion reforma o creacion bin'>0] = 1
datos2$'Elecciones bin'[datos2$'Elecciones bin'>0] = 1
datos2$'Reparto de territorios bin'[datos2$'Reparto de territorios bin'>0] = 1
datos2$'Reparto economico bin'[datos2$'Reparto economico bin'>0] = 1
datos2$'Reparto militar bin'[datos2$'Reparto militar bin'>0] = 1
datos2$'Igualdad de genero bin'[datos2$'Igualdad de genero bin'>0] = 1
datos2$'Democracia bin'[datos2$'Democracia bin'>0] = 1
datos2$'Desarrollo bin'[datos2$'Desarrollo bin'>0] = 1
datos2$'Alto el fuego bin'[datos2$'Alto el fuego bin'>0] = 1
datos2$'Corrupcion bin'[datos2$'Corrupcion bin'>0] = 1
datos2$'Crimer organizado bin'[datos2$'Crimer organizado bin'>0] = 1
datos2$'Justicia bin'[datos2$'Justicia bin'>0] = 1

# Lo discretizamos
datos2$'Grupo infancia bin' <- as.factor(datos2$'Grupo infancia bin')
datos2$'Grupo discapacitados bin' <- as.factor(datos2$'Grupo discapacitados bin')
datos2$'Grupo ancianos bin' <- as.factor(datos2$'Grupo ancianos bin')
datos2$'Grupo migrantes bin' <- as.factor(datos2$'Grupo migrantes bin')
datos2$'Grupo racial bin' <- as.factor(datos2$'Grupo racial bin')
datos2$'Grupo religion bin' <- as.factor(datos2$'Grupo religion bin')
datos2$'Grupo indigenas bin' <- as.factor(datos2$'Grupo indigenas bin')
datos2$'Grupo otros bin' <- as.factor(datos2$'Grupo otros bin')
datos2$'Grupo refugiados bin' <- as.factor(datos2$'Grupo refugiados bin')
datos2$'Grupo social bin' <- as.factor(datos2$'Grupo social bin')
datos2$'Constitucion reforma o creacion bin' <- as.factor(datos2$'Constitucion reforma o creacion bin')
datos2$'Elecciones bin' <- as.factor(datos2$'Elecciones bin')
datos2$'Reparto de territorios bin' <- as.factor(datos2$'Reparto de territorios bin')
datos2$'Reparto economico bin' <- as.factor(datos2$'Reparto economico bin')
datos2$'Reparto militar bin' <- as.factor(datos2$'Reparto militar bin')
datos2$'Igualdad de genero bin' <- as.factor(datos2$'Igualdad de genero bin')
datos2$'Democracia bin' <- as.factor(datos2$'Democracia bin')
datos2$'Desarrollo bin' <- as.factor(datos2$'Desarrollo bin')
datos2$'Alto el fuego bin' <- as.factor(datos2$'Alto el fuego bin')
datos2$'Corrupcion bin' <- as.factor(datos2$'Corrupcion bin')
datos2$'Crimer organizado bin' <- as.factor(datos2$'Crimer organizado bin')
datos2$'Justicia bin' <- as.factor(datos2$'Justicia bin')


# Despues de los cambios, analizamos la nueva estructura del juego de datos
str(datos2)

```

Creamos dos listas de paises: una con su nombre y otra con el código iso de tres letras para paises.

```{r echo=TRUE, message=FALSE, warning=FALSE}
# Creamos una lista con todos los paises
lista_paises <- c('Aruba','Afghanistan','Angola','Anguilla','Albania','Andorra','United Arab Emirates','Argentina','Armenia','American Samoa','Antarctica','French Southern Territories','Antigua and Barbuda','Australia','Austria','Azerbaijan','Burundi','Belgium','Benin','Burkina Faso','Bangladesh','Bulgaria','Bahrain','Bahamas','Bosnia and Herzegovina','Saint Bartholemy','Belarus','Belize','Bermuda','Bolivia','Brazil','Barbados','Brunei Darussalam','Bhutan','Bouvet Island','Botswana','Central African Republic','Canada','Cocos (Keeling) Islands','Switzerland','Chile','China','Cote d\'Ivoire','Cameroon','Democratic Republic of Congo','Republic of Congo','Cook Islands','Colombia','Comoros','Cape Verde','Costa Rica','Cuba','Christmas Island','Cayman Islands','Cyprus','Czech Republic','Germany','Djibouti','Dominica','Denmark','Dominican Republic','Algeria','Ecuador','Egypt','Eritrea','Western Sahara','Spain','Estonia','Ethiopia','Finland','Fiji','Falkland Islands (Malvinas)','France','Faroe Islands','Micronesia, Federated States of','Gabon','United Kingdom','Georgia','Guernsey','Ghana','Gibraltar','Guinea','Guadeloupe','Gambia','Guinea-Bissau','Equatorial Guinea','Greece','Grenada','Greenland','Guatemala','French Guiana','Guam','Guyana','Hong Kong','Heard Island and McDonald Islands','Honduras','Croatia','Haiti','Hungary','Indonesia','Isle of Man','India','British Indian Ocean Territory','Ireland','Iran','Iraq','Iceland','Israel','Italy','Jamaica','Jersey','Jordan','Japan','Kazakhstan','Kenya','Kyrgyzstan','Cambodia','Kiribati','Saint Kitts and Nevis','South Korea','Kuwait','Lao People\'s Democratic Republic','Lebanon','Liberia','Libya','Saint Lucia','Liechtenstein','Sri Lanka','Lesotho','Lithuania','Luxembourg','Latvia','Macao','Saint Martin (French part)','Morocco','Monaco','Moldova','Madagascar','Maldives','Mexico','Marshall Islands','Macedonia','Mali','Malta','Myanmar','Montenegro','Mongolia','Northern Mariana Islands','Mozambique','Mauritania','Montserrat','Martinique','Mauritius','Malawi','Malaysia','Mayotte','Namibia','New Caledonia','Niger','Norfolk Island','Nigeria','Nicaragua','Niue','Netherlands','Norway','Nepal','Nauru','New Zealand','Oman','Pakistan','Panama','Pitcairn','Peru','Philippines','Palau','Papua New Guinea','Poland','Puerto Rico','North Korea','Portugal','Paraguay','Palestine','French Polynesia','Qatar','Reunion','Romania','Russia','Rwanda','Saudi Arabia','Sudan','Senegal','Singapore','South Georgia and the South Sandwich Islands','Saint Helena, Ascension and Tristan da Cunha','Svalbard and Jan Mayen','Solomon Islands','Sierra Leone','El Salvador','San Marino','Somalia','Saint Pierre and Miquelon','Serbia','Sao Tome and Principe','Suriname','Slovakia','Slovenia','Sweden','Swaziland','Seychelles','Syria','Turks and Caicos Islands','Chad','Togo','Thailand','Tajikistan','Tokelau','Turkmenistan','Timor','Tonga','Trinidad and Tobago','Tunisia','Turkey','Tuvalu','Taiwan','Tanzania','Uganda','Ukraine','United States Minor Outlying Islands','Uruguay','United States','Uzbekistan','Holy See (Vatican City State)','Saint Vincent and the Grenadines','Venezuela','Virgin Islands, British','Virgin Islands, U.S.','Viet Nam','Vanuatu','Wallis and Futuna','Samoa','Yemen','South Africa','Zimbabwe','Zambia','South Sudan')


lista_paises_siglas <- c('ABW','AFG','AGO','AIA','ALB','AND','ARE','ARG','ARM','ASM','ATA','ATF','ATG','AUS','AUT','AZE','BDI','BEL','BEN','BFA','BGD','BGR','BHR','BHS','BIH','BLM','BLR','BLZ','BMU','BOL','BRA','BRB','BRN','BTN','BVT','BWA','CAF','CAN','CCK','CHE','CHL','CHN','CIV','CMR','COD','COG','COK','COL','COM','CPV','CRI','CUB','CXR','CYM','CYP','CZE','DEU','DJI','DMA','DNK','DOM','DZA','ECU','EGY','ERI','ESH','ESP','EST','ETH','FIN','FJI','FLK','FRA','FRO','FSM','GAB','GBR','GEO','GGY','GHA','GIB','GIN','GLP','GMB','GNB','GNQ','GRC','GRD','GRL','GTM','GUF','GUM','GUY','HKG','HMD','HND','HRV','HTI','HUN','IDN','IMN','IND','IOT','IRL','IRN','IRQ','ISL','ISR','ITA','JAM','JEY','JOR','JPN','KAZ','KEN','KGZ','KHM','KIR','KNA','KOR','KWT','LAO','LBN','LBR','LBY','LCA','LIE','LKA','LSO','LTU','LUX','LVA','MAC','MAF','MAR','MCO','MDA','MDG','MDV','MEX','MHL','MKD','MLI','MLT','MMR','MNE','MNG','MNP','MOZ','MRT','MSR','MTQ','MUS','MWI','MYS','MYT','NAM','NCL','NER','NFK','NGA','NIC','NIU','NLD','NOR','NPL','NRU','NZL','OMN','PAK','PAN','PCN','PER','PHL','PLW','PNG','POL','PRI','PRK','PRT','PRY','PSE','PYF','QAT','REU','ROU','RUS','RWA','SAU','SDN','SEN','SGP','SGS','SHN','SJM','SLB','SLE','SLV','SMR','SOM','SPM','SRB','STP','SUR','SVK','SVN','SWE','SWZ','SYC','SYR','TCA','TCD','TGO','THA','TJK','TKL','TKM','TLS','TON','TTO','TUN','TUR','TUV','TWN','TZA','UGA','UKR','UMI','URY','USA','UZB','VAT','VCT','VEN','VGB','VIR','VNM','VUT','WLF','WSM','YEM','ZAF','ZWE','ZMB','SSD')
```



Creamos un dataframe con los paises que han participado en cada conflicto


```{r echo=TRUE, message=FALSE, warning=FALSE}

aux = str_detect(datos2$`Paises/Entidades`, lista_paises[1])
df_lista_paises <- data.frame(ABW=aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[2])
df_lista_paises <- mutate(df_lista_paises, AFG = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[3])
df_lista_paises <- mutate(df_lista_paises, AGO = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[4])
df_lista_paises <- mutate(df_lista_paises, AIA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[5])
df_lista_paises <- mutate(df_lista_paises, ALB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[6])
df_lista_paises <- mutate(df_lista_paises, AND = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[7])
df_lista_paises <- mutate(df_lista_paises, ARE = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[8])
df_lista_paises <- mutate(df_lista_paises, ARG = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[9])
df_lista_paises <- mutate(df_lista_paises, ARM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[10])
df_lista_paises <- mutate(df_lista_paises, ASM = aux)

aux = str_detect(datos2$`Paises/Entidades`, lista_paises[11])
df_lista_paises <- mutate(df_lista_paises, ATA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[12])
df_lista_paises <- mutate(df_lista_paises, ATF = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[13])
df_lista_paises <- mutate(df_lista_paises, ATG = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[14])
df_lista_paises <- mutate(df_lista_paises, AUS = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[15])
df_lista_paises <- mutate(df_lista_paises, AUT = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[16])
df_lista_paises <- mutate(df_lista_paises, AZE = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[17])
df_lista_paises <- mutate(df_lista_paises, BDI = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[18])
df_lista_paises <- mutate(df_lista_paises, BEL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[19])
df_lista_paises <- mutate(df_lista_paises, BEN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[20])
df_lista_paises <- mutate(df_lista_paises, BFA = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[21])
df_lista_paises <- mutate(df_lista_paises, BGD = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[22])
df_lista_paises <- mutate(df_lista_paises, BGR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[23])
df_lista_paises <- mutate(df_lista_paises, BHR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[24])
df_lista_paises <- mutate(df_lista_paises, BHS = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[25])
df_lista_paises <- mutate(df_lista_paises, BIH = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[26])
df_lista_paises <- mutate(df_lista_paises, BLM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[27])
df_lista_paises <- mutate(df_lista_paises, BLR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[28])
df_lista_paises <- mutate(df_lista_paises, BLZ = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[29])
df_lista_paises <- mutate(df_lista_paises, BMU = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[30])
df_lista_paises <- mutate(df_lista_paises, BOL = aux)



aux = str_detect(datos2$`Paises/Entidades`, lista_paises[31])
df_lista_paises <- mutate(df_lista_paises, BRA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[32])
df_lista_paises <- mutate(df_lista_paises, BRB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[33])
df_lista_paises <- mutate(df_lista_paises, BRN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[34])
df_lista_paises <- mutate(df_lista_paises, BTN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[35])
df_lista_paises <- mutate(df_lista_paises, BVT = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[36])
df_lista_paises <- mutate(df_lista_paises, BWA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[37])
df_lista_paises <- mutate(df_lista_paises, CAF = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[38])
df_lista_paises <- mutate(df_lista_paises, CAN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[39])
df_lista_paises <- mutate(df_lista_paises, CCK = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[40])
df_lista_paises <- mutate(df_lista_paises, CHE = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[41])
df_lista_paises <- mutate(df_lista_paises, CHL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[42])
df_lista_paises <- mutate(df_lista_paises, CHN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[43])
df_lista_paises <- mutate(df_lista_paises, CIV = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[44])
df_lista_paises <- mutate(df_lista_paises, CMR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[45])
df_lista_paises <- mutate(df_lista_paises, COD = aux)
# Caso especial de Republic of Congo, que tiene que distinguirse de Democratic Republic of Congo
frase = datos2$`Paises/Entidades`
patron = "/Democratic Republic of Congo[/A-z]*/Republic of Congo/"
#aux = (str_detect(frase, patron)) || (((str_detect(frase, lista_paises[46] ) ) && ! (str_detect(frase, lista_paises[45]))))
aux1 = str_detect(frase, patron)
aux2 = str_detect(frase, lista_paises[46])
aux3 = str_detect(frase, lista_paises[45])
aux = aux1 || (aux2 && !aux3)
for (i in 1:length(aux1)) {
  aux[i] = aux1[i] || (aux2[i] && (!aux3[i]))
}
df_lista_paises <- mutate(df_lista_paises, COG = aux)
# Fin caso especial de Republic of Congo
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[47])
df_lista_paises <- mutate(df_lista_paises, COK = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[48])
df_lista_paises <- mutate(df_lista_paises, COL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[49])
df_lista_paises <- mutate(df_lista_paises, COM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[50])
df_lista_paises <- mutate(df_lista_paises, CPV = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[51])
df_lista_paises <- mutate(df_lista_paises, CRI = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[52])
df_lista_paises <- mutate(df_lista_paises, CUB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[53])
df_lista_paises <- mutate(df_lista_paises, CXR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[54])
df_lista_paises <- mutate(df_lista_paises, CYM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[55])
df_lista_paises <- mutate(df_lista_paises, CYP = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[56])
df_lista_paises <- mutate(df_lista_paises, CZE = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[57])
df_lista_paises <- mutate(df_lista_paises, DEU = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[58])
df_lista_paises <- mutate(df_lista_paises, DJI = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[59])
df_lista_paises <- mutate(df_lista_paises, DMA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[60])
df_lista_paises <- mutate(df_lista_paises, DNK = aux)

aux = str_detect(datos2$`Paises/Entidades`, lista_paises[61])
df_lista_paises <- mutate(df_lista_paises, DOM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[62])
df_lista_paises <- mutate(df_lista_paises, DZA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[63])
df_lista_paises <- mutate(df_lista_paises, ECU = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[64])
df_lista_paises <- mutate(df_lista_paises, EGY = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[65])
df_lista_paises <- mutate(df_lista_paises, ERI = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[66])
df_lista_paises <- mutate(df_lista_paises, ESH = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[67])
df_lista_paises <- mutate(df_lista_paises, ESP = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[68])
df_lista_paises <- mutate(df_lista_paises, EST = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[69])
df_lista_paises <- mutate(df_lista_paises, ETH = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[70])
df_lista_paises <- mutate(df_lista_paises, FIN = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[71])
df_lista_paises <- mutate(df_lista_paises, FJI = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[72])
df_lista_paises <- mutate(df_lista_paises, FLK = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[73])
df_lista_paises <- mutate(df_lista_paises, FRA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[74])
df_lista_paises <- mutate(df_lista_paises, FRO = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[75])
df_lista_paises <- mutate(df_lista_paises, FSM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[76])
df_lista_paises <- mutate(df_lista_paises, GAB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[77])
df_lista_paises <- mutate(df_lista_paises, GBR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[78])
df_lista_paises <- mutate(df_lista_paises, GEO = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[79])
df_lista_paises <- mutate(df_lista_paises, GGY = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[80])
df_lista_paises <- mutate(df_lista_paises, GHA = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[81])
df_lista_paises <- mutate(df_lista_paises, GIB = aux)
#aux = str_detect(datos2$`Paises/Entidades`, lista_paises[82])
#df_lista_paises <- mutate(df_lista_paises, GIN = aux)
#Caso Especial Guinea
aux1 = str_detect(datos2$`Paises/Entidades`, lista_paises[82])
aux2 = str_detect(datos2$`Paises/Entidades`, lista_paises[85])
aux3 = str_detect(datos2$`Paises/Entidades`, lista_paises[176])
for (i in 1:length(aux1)) {
  aux[i] = aux1[i] && (!(aux2[i] || aux3[i]))
}
#aux = aux1 && (!aux2)
df_lista_paises <- mutate(df_lista_paises, GIN = aux)
# Fin caso Especial Guinea
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[83])
df_lista_paises <- mutate(df_lista_paises, GLP = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[84])
df_lista_paises <- mutate(df_lista_paises, GMB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[85])
df_lista_paises <- mutate(df_lista_paises, GNB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[86])
df_lista_paises <- mutate(df_lista_paises, GNQ = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[87])
df_lista_paises <- mutate(df_lista_paises, GRC = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[88])
df_lista_paises <- mutate(df_lista_paises, GRD = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[89])
df_lista_paises <- mutate(df_lista_paises, GRL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[90])
df_lista_paises <- mutate(df_lista_paises, GTM = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[91])
df_lista_paises <- mutate(df_lista_paises, GUF = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[92])
df_lista_paises <- mutate(df_lista_paises, GUM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[93])
df_lista_paises <- mutate(df_lista_paises, GUY = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[94])
df_lista_paises <- mutate(df_lista_paises, HKG = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[95])
df_lista_paises <- mutate(df_lista_paises, HMD = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[96])
df_lista_paises <- mutate(df_lista_paises, HND = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[97])
df_lista_paises <- mutate(df_lista_paises, HRV = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[98])
df_lista_paises <- mutate(df_lista_paises, HTI = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[99])
df_lista_paises <- mutate(df_lista_paises, HUN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[100])
df_lista_paises <- mutate(df_lista_paises, IDN = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[101])
df_lista_paises <- mutate(df_lista_paises, IMN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[102])
df_lista_paises <- mutate(df_lista_paises, IND = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[103])
df_lista_paises <- mutate(df_lista_paises, IOT = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[104])
df_lista_paises <- mutate(df_lista_paises, IRL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[105])
df_lista_paises <- mutate(df_lista_paises, IRN = aux)
#aux = str_detect(datos2$`Paises/Entidades`, lista_paises[106])
#df_lista_paises <- mutate(df_lista_paises, IRQ = aux)
# Caso especial Irak y kurdistan
aux1 = str_detect(datos2$`Paises/Entidades`, lista_paises[106])
aux2 = str_detect(datos2$`Paises/Entidades`, 'Kurdistan')
for (i in 1:length(aux1)) {
  aux[i] = aux1[i] || aux2[i]
}
df_lista_paises <- mutate(df_lista_paises, IRQ = aux)
# fin caso especial Irak y Kurdistan
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[107])
df_lista_paises <- mutate(df_lista_paises, ISL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[108])
df_lista_paises <- mutate(df_lista_paises, ISR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[109])
df_lista_paises <- mutate(df_lista_paises, ITA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[110])
df_lista_paises <- mutate(df_lista_paises, JAM = aux)



aux = str_detect(datos2$`Paises/Entidades`, lista_paises[111])
df_lista_paises <- mutate(df_lista_paises, JEY = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[112])
df_lista_paises <- mutate(df_lista_paises, JOR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[113])
df_lista_paises <- mutate(df_lista_paises, JPN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[114])
df_lista_paises <- mutate(df_lista_paises, KAZ = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[115])
df_lista_paises <- mutate(df_lista_paises, KEN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[116])
df_lista_paises <- mutate(df_lista_paises, KGZ = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[117])
df_lista_paises <- mutate(df_lista_paises, KHM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[118])
df_lista_paises <- mutate(df_lista_paises, KIR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[119])
df_lista_paises <- mutate(df_lista_paises, KNA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[120])
df_lista_paises <- mutate(df_lista_paises, KOR = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[121])
df_lista_paises <- mutate(df_lista_paises, KWT = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[122])
df_lista_paises <- mutate(df_lista_paises, LAO = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[123])
df_lista_paises <- mutate(df_lista_paises, LBN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[124])
df_lista_paises <- mutate(df_lista_paises, LBR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[125])
df_lista_paises <- mutate(df_lista_paises, LBY = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[126])
df_lista_paises <- mutate(df_lista_paises, LCA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[127])
df_lista_paises <- mutate(df_lista_paises, LIE = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[128])
df_lista_paises <- mutate(df_lista_paises, LKA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[129])
df_lista_paises <- mutate(df_lista_paises, LSO = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[130])
df_lista_paises <- mutate(df_lista_paises, LTU = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[131])
df_lista_paises <- mutate(df_lista_paises, LUX = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[132])
df_lista_paises <- mutate(df_lista_paises, LVA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[133])
df_lista_paises <- mutate(df_lista_paises, MAC = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[134])
df_lista_paises <- mutate(df_lista_paises, MAF = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[135])
df_lista_paises <- mutate(df_lista_paises, MAR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[136])
df_lista_paises <- mutate(df_lista_paises, MCO = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[137])
df_lista_paises <- mutate(df_lista_paises, MDA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[138])
df_lista_paises <- mutate(df_lista_paises, MDG = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[139])
df_lista_paises <- mutate(df_lista_paises, MDV = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[140])
df_lista_paises <- mutate(df_lista_paises, MEX = aux)



aux = str_detect(datos2$`Paises/Entidades`, lista_paises[141])
df_lista_paises <- mutate(df_lista_paises, MHL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[142])
df_lista_paises <- mutate(df_lista_paises, MKD = aux)
#aux = str_detect(datos2$`Paises/Entidades`, lista_paises[143])
#df_lista_paises <- mutate(df_lista_paises, MLI = aux)
# Caso especial Mali y Air and Azawad
aux1 = str_detect(datos2$`Paises/Entidades`, lista_paises[143])
aux2 = str_detect(datos2$`Paises/Entidades`, 'Air and Azawad')
for (i in 1:length(aux1)) {
  aux[i] = aux1[i] || aux2[i]
}
df_lista_paises <- mutate(df_lista_paises, MLI = aux)
# Fin Caso especial Mali y Air and Azawad
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[144])
df_lista_paises <- mutate(df_lista_paises, MLT = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[145])
df_lista_paises <- mutate(df_lista_paises, MMR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[146])
df_lista_paises <- mutate(df_lista_paises, MNE = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[147])
df_lista_paises <- mutate(df_lista_paises, MNG = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[148])
df_lista_paises <- mutate(df_lista_paises, MNP = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[149])
df_lista_paises <- mutate(df_lista_paises, MOZ = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[150])
df_lista_paises <- mutate(df_lista_paises, MRT = aux)

aux = str_detect(datos2$`Paises/Entidades`, lista_paises[151])
df_lista_paises <- mutate(df_lista_paises, MSR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[152])
df_lista_paises <- mutate(df_lista_paises, MTQ = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[153])
df_lista_paises <- mutate(df_lista_paises, MUS = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[154])
df_lista_paises <- mutate(df_lista_paises, MWI = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[155])
df_lista_paises <- mutate(df_lista_paises, MYS = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[156])
df_lista_paises <- mutate(df_lista_paises, MYT = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[157])
df_lista_paises <- mutate(df_lista_paises, NAM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[158])
df_lista_paises <- mutate(df_lista_paises, NCL = aux)
#aux = str_detect(datos2$`Paises/Entidades`, lista_paises[159])
#df_lista_paises <- mutate(df_lista_paises, NER = aux)
# CASO ESPECIAL NIGER
aux1 = str_detect(datos2$`Paises/Entidades`, lista_paises[159])
aux2 = str_detect(datos2$`Paises/Entidades`, lista_paises[161])
for (i in 1:length(aux1)) {
  aux[i] = aux1[i] && (!aux2[i])
}
df_lista_paises <- mutate(df_lista_paises, NER = aux)
# FIN CASO ESPECIAL NIGER
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[160])
df_lista_paises <- mutate(df_lista_paises, NFK = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[161])
df_lista_paises <- mutate(df_lista_paises, NGA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[162])
df_lista_paises <- mutate(df_lista_paises, NIC = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[163])
df_lista_paises <- mutate(df_lista_paises, NIU = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[164])
df_lista_paises <- mutate(df_lista_paises, NLD = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[165])
df_lista_paises <- mutate(df_lista_paises, NOR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[166])
df_lista_paises <- mutate(df_lista_paises, NPL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[167])
df_lista_paises <- mutate(df_lista_paises, NRU = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[168])
df_lista_paises <- mutate(df_lista_paises, NZL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[169])
df_lista_paises <- mutate(df_lista_paises, OMN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[170])
df_lista_paises <- mutate(df_lista_paises, PAK = aux)



aux = str_detect(datos2$`Paises/Entidades`, lista_paises[171])
df_lista_paises <- mutate(df_lista_paises, PAN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[172])
df_lista_paises <- mutate(df_lista_paises, PCN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[173])
df_lista_paises <- mutate(df_lista_paises, PER = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[174])
df_lista_paises <- mutate(df_lista_paises, PHL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[175])
df_lista_paises <- mutate(df_lista_paises, PLW = aux)
#aux = str_detect(datos2$`Paises/Entidades`, lista_paises[176])
#df_lista_paises <- mutate(df_lista_paises, PNG = aux)
# Caso especial Bougainville
aux1 = str_detect(datos2$`Paises/Entidades`, lista_paises[176])
aux2 = str_detect(datos2$`Paises/Entidades`, 'Bougainville')
for (i in 1:length(aux1)) {
  aux[i] = aux1[i] || aux2[i]
}
df_lista_paises <- mutate(df_lista_paises, PNG = aux)
# fin caso especial Bougainville
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[177])
df_lista_paises <- mutate(df_lista_paises, POL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[178])
df_lista_paises <- mutate(df_lista_paises, PRI = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[179])
df_lista_paises <- mutate(df_lista_paises, PRK = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[180])
df_lista_paises <- mutate(df_lista_paises, PRT = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[181])
df_lista_paises <- mutate(df_lista_paises, PRY = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[182])
df_lista_paises <- mutate(df_lista_paises, PSE = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[183])
df_lista_paises <- mutate(df_lista_paises, PYF = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[184])
df_lista_paises <- mutate(df_lista_paises, QAT = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[185])
df_lista_paises <- mutate(df_lista_paises, REU = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[186])
df_lista_paises <- mutate(df_lista_paises, ROU = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[187])
df_lista_paises <- mutate(df_lista_paises, RUS = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[188])
df_lista_paises <- mutate(df_lista_paises, RWA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[189])
df_lista_paises <- mutate(df_lista_paises, SAU = aux)
#aux = str_detect(datos2$`Paises/Entidades`, lista_paises[190])
#df_lista_paises <- mutate(df_lista_paises, SDN = aux)
# Caso especial Sudan 
aux1 = str_detect(datos2$`Paises/Entidades`, lista_paises[190])
aux2 = str_detect(datos2$`Paises/Entidades`, lista_paises[245])
aux3 = str_detect(datos2$`Paises/Entidades`, 'South Sudan/Sudan')
for (i in 1:length(aux1)) {
  aux[i] = aux3[i] || (aux1[i] && (!aux2[i]))
}
df_lista_paises <- mutate(df_lista_paises, SDN = aux)
# fin Caso especial Sudan


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[191])
df_lista_paises <- mutate(df_lista_paises, SEN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[192])
df_lista_paises <- mutate(df_lista_paises, SGP = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[193])
df_lista_paises <- mutate(df_lista_paises, SGS = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[194])
df_lista_paises <- mutate(df_lista_paises, SHN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[195])
df_lista_paises <- mutate(df_lista_paises, SJM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[196])
df_lista_paises <- mutate(df_lista_paises, SLB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[197])
df_lista_paises <- mutate(df_lista_paises, SLE = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[198])
df_lista_paises <- mutate(df_lista_paises, SLV = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[199])
df_lista_paises <- mutate(df_lista_paises, SMR = aux)
#aux = str_detect(datos2$`Paises/Entidades`, lista_paises[200])
#df_lista_paises <- mutate(df_lista_paises, SOM = aux)
# Caso especial SOMALIA Y SOMALILAND
aux1 = str_detect(datos2$`Paises/Entidades`, lista_paises[200])
aux2 = str_detect(datos2$`Paises/Entidades`, 'Somaliland')
for (i in 1:length(aux1)) {
  aux[i] = aux1[i] || aux2[i]
}
df_lista_paises <- mutate(df_lista_paises, SOM = aux)
# Fin caso especial Somalia y somaliland


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[201])
df_lista_paises <- mutate(df_lista_paises, SPM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[202])
df_lista_paises <- mutate(df_lista_paises, SRB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[203])
df_lista_paises <- mutate(df_lista_paises, STP = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[204])
df_lista_paises <- mutate(df_lista_paises, SUR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[205])
df_lista_paises <- mutate(df_lista_paises, SVK = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[206])
df_lista_paises <- mutate(df_lista_paises, SVN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[207])
df_lista_paises <- mutate(df_lista_paises, SWE = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[208])
df_lista_paises <- mutate(df_lista_paises, SWZ = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[209])
df_lista_paises <- mutate(df_lista_paises, SYC = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[210])
df_lista_paises <- mutate(df_lista_paises, SYR = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[211])
df_lista_paises <- mutate(df_lista_paises, TCA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[212])
df_lista_paises <- mutate(df_lista_paises, TCD = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[213])
df_lista_paises <- mutate(df_lista_paises, TGO = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[214])
df_lista_paises <- mutate(df_lista_paises, THA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[215])
df_lista_paises <- mutate(df_lista_paises, TJH = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[216])
df_lista_paises <- mutate(df_lista_paises, TKL = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[217])
df_lista_paises <- mutate(df_lista_paises, TKM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[218])
df_lista_paises <- mutate(df_lista_paises, TLS = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[219])
df_lista_paises <- mutate(df_lista_paises, TON = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[220])
df_lista_paises <- mutate(df_lista_paises, TTO = aux)



aux = str_detect(datos2$`Paises/Entidades`, lista_paises[221])
df_lista_paises <- mutate(df_lista_paises, TUN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[222])
df_lista_paises <- mutate(df_lista_paises, TUR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[223])
df_lista_paises <- mutate(df_lista_paises, TUV = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[224])
df_lista_paises <- mutate(df_lista_paises, TWN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[225])
df_lista_paises <- mutate(df_lista_paises, TZA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[226])
df_lista_paises <- mutate(df_lista_paises, UGA = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[227])
df_lista_paises <- mutate(df_lista_paises, UKR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[228])
df_lista_paises <- mutate(df_lista_paises, UMI = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[229])
df_lista_paises <- mutate(df_lista_paises, URY = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[230])
df_lista_paises <- mutate(df_lista_paises, USA = aux)



aux = str_detect(datos2$`Paises/Entidades`, lista_paises[231])
df_lista_paises <- mutate(df_lista_paises, UZB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[232])
df_lista_paises <- mutate(df_lista_paises, VAT = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[233])
df_lista_paises <- mutate(df_lista_paises, VCT = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[234])
df_lista_paises <- mutate(df_lista_paises, VEN = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[235])
df_lista_paises <- mutate(df_lista_paises, VGB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[236])
df_lista_paises <- mutate(df_lista_paises, VIR = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[237])
df_lista_paises <- mutate(df_lista_paises, VNM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[238])
df_lista_paises <- mutate(df_lista_paises, VUT = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[239])
df_lista_paises <- mutate(df_lista_paises, WLF = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[240])
df_lista_paises <- mutate(df_lista_paises, WSM = aux)


aux = str_detect(datos2$`Paises/Entidades`, lista_paises[241])
df_lista_paises <- mutate(df_lista_paises, YEM = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[242])
df_lista_paises <- mutate(df_lista_paises, ZAF = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[243])
df_lista_paises <- mutate(df_lista_paises, ZWE = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[244])
df_lista_paises <- mutate(df_lista_paises, ZWB = aux)
aux = str_detect(datos2$`Paises/Entidades`, lista_paises[245])
df_lista_paises <- mutate(df_lista_paises, SSD = aux)


```


Una vez hecha la matriz de paises, creamos una lista con los paises en codigo ISO para poder geolocalizarlos en Tableau. 

```{r echo=TRUE, message=FALSE, warning=FALSE}

lista_paises_participantes <- array()

for (i in 1:nrow(df_lista_paises)){
  for (j in 1:length(df_lista_paises)){
    if (df_lista_paises[i,j] == TRUE){
        if (is.na(lista_paises_participantes[i]) == FALSE) {
          lista_paises_participantes[i] =  paste(lista_paises_participantes[i], lista_paises_siglas[j], sep=" ")
        }else {
          lista_paises_participantes[i] =  lista_paises_siglas[j]
        }
    }
    if ((df_lista_paises[i,length(df_lista_paises)] == FALSE) && (is.na(lista_paises_participantes[i]) == TRUE)){
        lista_paises_participantes[i] = NA
      }
  }
}

datos2 <- mutate(datos2, PAISES = lista_paises_participantes)
```


Exportamos los datos a csv, para poder trabajar con ellos en Tableau. 

```{r echo=TRUE, message=FALSE, warning=FALSE}
# Exportación de los datos limpios
write.csv(datos2, "Datos_clean_PEC4.csv")
```



Generamos otro fichero *.csv con la lista de paises que están relacionados mediante un conflicto bélico, para cada pais. 

```{r echo=TRUE, message=FALSE, warning=FALSE}


lista_paises_participantes <- array()

for (i in 1:nrow(df_lista_paises)){
  for (j in 1:length(df_lista_paises)){
    if (df_lista_paises[i,j] == TRUE){
        for (k in 1:length(df_lista_paises)){
          if (k!=j) {
            if (df_lista_paises[i,k] == TRUE) { 
              if (is.na(lista_paises_participantes[j]) == FALSE) {
                if ( str_detect(lista_paises_participantes[j], lista_paises_siglas[k], negate = TRUE) ) {
                  lista_paises_participantes[j] =  paste(lista_paises_participantes[j], lista_paises_siglas[k], sep=" ")
                }
              }else {
                lista_paises_participantes[j] =  lista_paises_siglas[k]
              }
              
            }
            
          }
        }  
    }
  }
}

df_lista_paises_relacionados <- data.frame(lista_paises, lista_paises_siglas, 'Paises_relacionados'=lista_paises_participantes)

# Escribimos el fichero
write.csv(df_lista_paises_relacionados, "lista_paises_relacionados_R.csv")


```



Calcularemos ahora la correlación entre variables para ver que variables están más relacionadas entre ellas. 


```{r echo=TRUE, message=FALSE, warning=FALSE}

variables_seleccionadas <- c( "Grupo infancia","Grupo migrantes", "Grupo racial","Grupo religion","Grupo refugiados",
                              "Estado - autodeterminacion", "Constitucion reforma o creacion","Elecciones","Reparto de territorios",
                              "Reparto economico","Reparto militar","Igualdad de genero","Derechos civiles",
                              "Derechos socioeconomicos","Medio ambiente","Seguridad","Alto el fuego","Corrupcion",
                              "Crimer organizado","Terrorismo","Justicia")
reduc_data <- datos2[variables_seleccionadas]

reduc_data$`Estado - autodeterminacion` <- as.integer(reduc_data$`Estado - autodeterminacion`)
reduc_data$`Derechos civiles` <- as.integer(reduc_data$`Derechos civiles`)
reduc_data$`Derechos socioeconomicos` <- as.integer(reduc_data$`Derechos socioeconomicos`)
reduc_data$`Medio ambiente` <- as.integer(reduc_data$`Medio ambiente`)
reduc_data$Seguridad <- as.integer(reduc_data$Seguridad)
reduc_data$Terrorismo <- as.integer(reduc_data$Terrorismo)

M_cor<-cor(reduc_data)
corrplot(M_cor, type="lower", method="color")
```

